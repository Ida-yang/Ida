<template>
    <div>
        <el-row>
            <el-col :offset="6" :xs="4" :sm="4" :md="4" :lg="4">
                <el-card :body-style="{ padding: '0px' }">
                    <img src="../../../../assets/image/serialType1.png" class="image">
                    <div style="padding: 14px;">
                        <div class="bottom clearfix">
                            <el-radio v-model="barcodeStyle"    label="1" style="margin-left:30%">样式一</el-radio>
                        </div>
                    </div>
                </el-card>
            </el-col>
            <el-col :offset="1" :xs="4" :sm="4" :md="4" :lg="4">
                <el-card :body-style="{ padding: '0px' }">
                    <img src="../../../../assets/image/serialType2.png" class="image">
                    <div style="padding: 14px;">
                        <div class="bottom clearfix">
                            <el-radio v-model="barcodeStyle" label="2" style="margin-left:30%">样式二</el-radio>
                        </div>
                    </div>
                </el-card>
            </el-col>
            <el-col :offset="1" :xs="6" :sm="8" :md="8" :lg="6" >
                <div style="margin-top:3%">
                    <span>查找:</span>
                    <el-input v-model="selectInput" placeholder="序列号/编号/名称" style="width:60%"></el-input>
                </div>  
                <div style="margin-top:3%">
                    <span >打印份数</span>
                    <el-input-number size="mini" v-model="copiesNum" :min="1"></el-input-number>
                </div>
            </el-col>
        </el-row>
        <el-table
            ref="multipleTable"
            :data="dataList.slice((currentPage-1)*pageSize,currentPage*pageSize)"
            tooltip-effect="dark"
            style="width: 80%;margin-left:20%"
            height="380"
            @selection-change="handleSelectionChange">
            <el-table-column
            type="selection"
            align="center"
            width="100">
            </el-table-column>
            <el-table-column
            prop="snnum"
            fixed="left"
            label="序列号"
            align="center"
            header-align="center"
            width="180">
            </el-table-column>
            <el-table-column
            prop="productnum"
            fixed="left"
            label="产品编号"
            align="center"
            header-align="center"
            width="240">
            </el-table-column>
            <el-table-column
            prop="productname"
            label="产品名称"
            align="center"
            header-align="center"
            width="240">
            </el-table-column>
        </el-table>
        <div class="block numberPage">
            <el-pagination
            @size-change="handleSizeChange"
            @current-change="handleCurrentChange"
            :current-page="currentPage"
            :page-sizes="[10, 15, 25, 50]"
            :page-size="10"
            layout="total, sizes, prev, pager, next, jumper"
            :total="dataList.length">
            </el-pagination>
        </div>
        <el-row>
            <el-col :offset="10" :xs="4" :sm="4" :md="4" :lg="4" >
                <el-button type="primary" style="width:100%" @click="onSubmit">提  交</el-button>
            </el-col>
        </el-row>
    </div>
</template>
<style>
    .image {
        width: 100%;
        display: block;
    }
</style>

<script>
    import store from '../../../../store/store'
    import axios from 'axios'
    export default {
        name:'PrintSerialNumber',
        // computed: {
        //     Msgs (){
        //         var dataList = this.$store.state.serialArr;
        //         return dataList;
        //     }
        // },
        data(){
            return {
                dataList:[],
                barcodeStyle:'1',
                selectInput:'',
                copiesNum:1,
                tableNumber:null,
                currentPage:1,//默认第一页
                pageSize:10,//默认10条
            }
        },
        beforeCreate(){
            let _this=this
            let select = _this.$store.state.serialArr;
            _this.tableNumber = select.length;
            // console.log(_this.tableNumber)
            console.log(select)
            for(let i=0;i<select.length;i++){
                let selectData = {}
                selectData.productwoid = select[i].id;
                selectData.type = "pdfinish"
                axios({
                    method: 'post',
                    url: _this.$store.state.defaultHttp+_this.$store.state.serial+'selectByCriteria',
                    data:selectData,
                }).then(function(res){
                    let resList=res.data.result.records;
                    
                    for(let z=0;z<resList.length;z++){
                        let List={};
                        List.snnum=resList[z].snnum
                        List.productname=select[i].productname
                        List.productnum=select[i].productnum
                        _this.dataList.push(List)
                    } 
                }).catch(function(err){
                console.log(err)
                })
            }
        },
        methods:{
            onSubmit(){
                if(this.multipleSelection == undefined){
                    this.$message({
                        message: '请选择需要打印的序列号',
                        type: 'warning'
                    });
                    return
                }
                if(this.multipleSelection.length == 0 ){
                    this.$message({
                        message: '请选择需要打印的序列号',
                        type: 'warning'
                    });
                    return
                }

            },
            handleSelectionChange(val) {
                this.multipleSelection = val;
            },
            handleSizeChange(val) {
               this.pageSize = val
                
            },
            handleCurrentChange(val) {
               this.currentPage = val
            },
        },
        beforeUpdate() {
        },
        
        
    }
</script>
